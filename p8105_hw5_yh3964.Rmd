---
title: "p8105_hw5_yh3964"
author: "Yirou Hu"
date: "2025-11-02"
output: github_document
---
```{r}
library(tidyverse)
theme_set(theme_minimal() + theme(legend.position = "bottom"))  
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
```

# Problem 1
Suppose you put n people in a room, and want to know the probability that at least two people share a birthday. For simplicity, we’ll assume there are no leap years (i.e. there are only 365 days) and that birthdays are uniformly distributed over the year (which is actually not the case).

- write a function that, for a fixed group size, randomly draws “birthdays” for each person; 
- checks whether there are duplicate birthdays in the group; 
- returns TRUE or FALSE based on the result.

```{r}
# Define simulation birthday
birthday_sim = function(n_room) {
  birthdays = sample(1:365, n_room, replace = TRUE)
  rep_birthday = length(unique(birthdays)) < n_room
  rep_birthday
}
```

- Run this function 10000 times for each group size between 2 and 50. 
- For each group size, compute the probability that at least two people in the group will share a birthday by averaging across the 10000 simulation runs. 
- Make a plot showing the probability as a function of group size, and comment on your results

```{r}
group_sizes = 2:50
n_simulations = 10000

birthday_prob = 
  tibble(group_size = group_sizes) |> 
  mutate(
    simulation_results = map(group_size, ~replicate(n_simulations, birthday_sim(.x))),
    prob_duplicate = map_dbl(simulation_results, mean)
  ) |> 
  select(group_size, prob_duplicate)
```

